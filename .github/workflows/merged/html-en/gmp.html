<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="15 Using a Master-Sensor Setup" href="master-sensor-setup.html" /><link rel="prev" title="13 Managing SecInfo" href="managing-secinfo.html" />
        <link rel="prefetch" href="_static/logo.png" as="image" />

    <link rel="shortcut icon" href="_static/Gb_favicon_head_32x32.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2025.07.19 -->
        <title>14 Using the Greenbone Management Protocol - Greenbone Enterprise Appliance – GOS 24.10.4</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_greenbone.css?v=86d35ff1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Roboto, Helvetica, sans-serif;
  --color-content-foreground: #4D4D4D;
  --color-foreground-primary: 4D4D4D;
  --color-foreground-secondary: #808080;
  --color-code-background: #333333;
  --color-code-foreground: #E6E6E6;
  --color-admonition-title--note: #11AB51;
  --color-admonition-title--note-background: #D8F1E2;
  --color-admonition-title--warning: #E5393D;
  --color-admonition-title--warning-background: #FBDDDE;
  --admonition-font-size: 0.9rem;
  --color-background-primary: #FFFFFF;
  --color-background-secondary: #F5F5F5;
  --color-sidebar-background: #F5F5F5;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --font-stack: Roboto, Helvetica, sans-serif;
  --color-content-foreground: #F5F5F5;
  --color-foreground-primary: F5F5F5;
  --color-foreground-secondary: #E6E6E6;
  --color-code-background: #333333;
  --color-code-foreground: #E6E6E6;
  --color-admonition-title--note: #11AB51;
  --admonition-font-size: 0.9rem;
  --color-background-primary: #171717;
  --color-background-secondary: #4D4D4D;
  --color-sidebar-background: #333333;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --font-stack: Roboto, Helvetica, sans-serif;
  --color-content-foreground: #F5F5F5;
  --color-foreground-primary: F5F5F5;
  --color-foreground-secondary: #E6E6E6;
  --color-code-background: #333333;
  --color-code-foreground: #E6E6E6;
  --color-admonition-title--note: #11AB51;
  --admonition-font-size: 0.9rem;
  --color-background-primary: #171717;
  --color-background-secondary: #4D4D4D;
  --color-sidebar-background: #333333;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Greenbone Enterprise Appliance – GOS 24.10.4</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Greenbone Enterprise Appliance – GOS 24.10.4</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1 Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-before-use.html">2 Read Before Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="appliance-overview.html">3 Greenbone Enterprise Appliance – Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-up-the-appliance.html">4 Setting up the Greenbone Enterprise Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrading-gos.html">5 Upgrading the Greenbone Enterprise Appliance to the Latest Major Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing-gos.html">6 Managing the Greenbone Operating System</a></li>
<li class="toctree-l1"><a class="reference internal" href="web-interface.html">7 Getting to Know the Web Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="web-interface-access.html">8 Managing the Web Interface Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="scanning.html">9 Scanning a System</a></li>
<li class="toctree-l1"><a class="reference internal" href="reports.html">10 Reports and Vulnerability Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="compliance-and-special-scans.html">11 Performing Compliance Scans and Special Scans</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing-assets.html">12 Managing Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing-secinfo.html">13 Managing SecInfo</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">14 Using the Greenbone Management Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="master-sensor-setup.html">15 Using a Master-Sensor Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">16 Managing the Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="connecting-other-systems.html">17 Connecting the Greenbone Enterprise Appliance to Other Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">18 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">19 Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">20 Glossary</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="using-the-greenbone-management-protocol">
<span id="gmp"></span><span id="index-0"></span><h1><span class="section-number">14 </span>Using the Greenbone Management Protocol<a class="headerlink" href="#using-the-greenbone-management-protocol" title="Link to this heading">¶</a></h1>
<p>The vulnerability management functionality of the Greenbone Enterprise Appliance is also available via the Greenbone Management Protocol (GMP).
GMP is a XML-based human-readable, stateless request-response protocol.</p>
<p>Greenbone provides the Greenbone Vulnerability Management Tools (gvm-tools) to access the functionality made available by GMP (see Chapter <a class="reference internal" href="#tools-gmp"><span class="std std-ref">14.3</span></a>).</p>
<p>The newest version of GMP is documented at <a class="reference external" href="https://docs.greenbone.net/API/GMP/gmp-22.6.html">https://docs.greenbone.net/API/GMP/gmp-22.6.html</a>.</p>
<section id="changes-to-gmp">
<span id="index-1"></span><h2><span class="section-number">14.1 </span>Changes to GMP<a class="headerlink" href="#changes-to-gmp" title="Link to this heading">¶</a></h2>
<p>GMP is regularly updated to apply changes in the functionality provided by the underlying service and to provide a consistent and comprehensive interface.</p>
<p>Updates result in a new version of GMP.
Each new version includes a list of added, modified and removed protocol elements, for example commands or attributes.
The most recent version of the list is available at <a class="reference external" href="https://docs.greenbone.net/API/GMP/gmp-22.6.html#changes">https://docs.greenbone.net/API/GMP/gmp-22.6.html#changes</a>.</p>
<p>Depending on the changes, the old version may be available for some time.
During this transitional phase, the new and the old version are available at the same time.</p>
<p>This list helps to prepare for upcoming changes as soon as possible.
It does not represent the complete list of upcoming changes.</p>
</section>
<section id="activating-gmp">
<span id="id1"></span><h2><span class="section-number">14.2 </span>Activating GMP<a class="headerlink" href="#activating-gmp" title="Link to this heading">¶</a></h2>
<p>Before GMP can be used, it must be activated on the appliance.</p>
<p>While the web interface uses GMP locally on the appliance, GMP is not remotely accessible via the network by default.</p>
<p>The remote GMP service can be activated using the GOS administration menu (see Chapter <a class="reference internal" href="managing-gos.html#configuring-gmp"><span class="std std-ref">6.2.4.2</span></a>).</p>
<p>In general, the access to GMP is authenticated and encrypted with SSL/TLS.
The same users as for the web interface are used.
The users are subject to the same restrictions and have the same permissions.</p>
</section>
<section id="using-gvm-tools">
<span id="tools-gmp"></span><span id="index-2"></span><h2><span class="section-number">14.3 </span>Using gvm-tools<a class="headerlink" href="#using-gvm-tools" title="Link to this heading">¶</a></h2>
<p>The Greenbone Vulnerability Management Tools (gvm-tools) are a collection of tools that provide access to the functionalities of the Greenbone Management Protocol (GMP).
GMP scripts executed with <code class="docutils literal notranslate"><span class="pre">gvm-script</span></code> use the API provided by the library <a class="reference external" href="https://greenbone.github.io/python-gvm/">python-gvm</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>python-gvm is automatically installed when installing gvm-tools.</p>
</div>
<p>gvm-tools are available as a command line interface (CLI) and as a Python shell for any operating system that supports Python.</p>
<p>The following versions are required to use gvm-tools with GOS 24.10:</p>
<ul class="simple">
<li><p>gvm-tools: 25.1.1 or higher</p></li>
<li><p>python-gvm: 26.0.0 or higher</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both gvm-tools and python-gvm use a different version scheme than GOS, so the versions of gvm-tools, python-gvm and GOS are not necessarily the same.</p>
<p>It is recommended to use the latest versions of gvm-tools and python-gvm.</p>
</div>
<p>gvm-tools can be downloaded at the project’s official <a class="reference external" href="https://github.com/greenbone/gvm-tools">GitHub repository</a>.
Python 3.9 or later is required.
To install gvm-tools, follow the instructions provided at <a class="reference external" href="https://greenbone.github.io/gvm-tools/">https://greenbone.github.io/gvm-tools/</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>External links to the Greenbone download website are case-sensitive.</p>
<p>Note that upper cases, lower cases and special characters have to be entered exactly as they are written in the footnotes.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>gvm-tools are licensed under the GNU General Public License v3.0 and may be adapted and built for other uses cases, based on the source code.</p>
</div>
<section id="accessing-with-gvm-cli">
<span id="index-3"></span><h3><span class="section-number">14.3.1 </span>Accessing with <code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code><a class="headerlink" href="#accessing-with-gvm-cli" title="Link to this heading">¶</a></h3>
<p>GMP is XML based. Every command and every response is a GMP object.</p>
<p>The command line tool <span class="target" id="gos-cmd-0"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> supplied by Greenbone offers direct sending and receiving of XML commands and responses.</p>
<p><span class="target" id="gos-cmd-1"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> supports the following connections:</p>
<ul class="simple">
<li><p>SSH</p></li>
<li><p>TLS</p></li>
<li><p>Unix Domain Socket</p></li>
</ul>
<p><span class="target" id="gos-cmd-2"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> supports several command line switches which can be displayed using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gvm-cli -h
usage: gvm-cli [-h] [-c [CONFIG]]
             [--log [{DEBUG,INFO,WARNING,ERROR,CRITICAL}]]
             [--timeout TIMEOUT] [--gmp-username GMP_USERNAME]
             [--gmp-password GMP_PASSWORD] [-V] [--protocol {GMP,OSP}]
             CONNECTION_TYPE ...

optional arguments:
  -h, --help            show this help message and exit
  -c [CONFIG], --config [CONFIG]
                        Configuration file path (default: ~/.config/gvm-
                        tools.conf)
  --log [{DEBUG,INFO,WARNING,ERROR,CRITICAL}]
                        Activate logging (default level: None)
  --timeout TIMEOUT     Response timeout in seconds, or -1 to wait
                        indefinitely (default: 60)
  --gmp-username GMP_USERNAME
                        Username for GMP service (default: &#39;&#39;)
  --gmp-password GMP_PASSWORD
                        Password for GMP service (default: &#39;&#39;)
  -V, --version         Show version information and exit
  --protocol {GMP,OSP}  Service protocol to use (default: GMP)

connections:
  valid connection types

  CONNECTION_TYPE       Connection type to use
    ssh                 Use SSH to connect to service
    tls                 Use TLS secured connection to connect to service
    socket              Use UNIX Domain socket to connect to service
</pre></div>
</div>
<p>While <span class="target" id="gos-cmd-3"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> supports more command line switches the additional options are only displayed when the connection type is specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gvm-cli ssh -h
usage: gvm-cli ssh [-h] --hostname HOSTNAME [--port PORT]
                 [--ssh-username SSH_USERNAME]
                 [--ssh-password SSH_PASSWORD] [-X XML] [-r] [--pretty]
                 [--duration]
                 [infile]

positional arguments:
  infile                File to read XML commands from.

optional arguments:
  -h, --help            show this help message and exit
  --hostname HOSTNAME   Hostname or IP address
  --port PORT           SSH port (default: 22)
  --ssh-username SSH_USERNAME
                        SSH username (default: &#39;gmp&#39;)
  --ssh-password SSH_PASSWORD
                        SSH password (default: &#39;gmp&#39;)
  -X XML, --xml XML     XML request to send
  -r, --raw             Return raw XML
  --pretty              Pretty format the returned xml
  --duration            Measure command execution time
</pre></div>
</div>
<p>All current appliances use SSH to encrypt GMP. The use of TLS is deprecated, not officially supported and may be removed in a future version.</p>
<p>The gvm-tools are mostly helpful for batch mode (<code class="docutils literal notranslate"><span class="pre">batch</span> <span class="pre">processing</span></code>, <code class="docutils literal notranslate"><span class="pre">scripting</span></code>).</p>
<p>With <span class="target" id="gos-cmd-4"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> GMP can be used in a simple way:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gvm-cli<span class="w"> </span>--xml<span class="w"> </span><span class="s2">&quot;&lt;get_version/&gt;&quot;</span>
gvm-cli<span class="w"> </span>--xml<span class="w"> </span><span class="s2">&quot;&lt;get_tasks/&gt;&quot;</span>
gvm-cli<span class="w"> </span>&lt;<span class="w"> </span>file
</pre></div>
</div>
<section id="configuring-the-client">
<span id="gvm-cli-conf"></span><span id="index-4"></span><h4><span class="section-number">14.3.1.1 </span>Configuring the Client<a class="headerlink" href="#configuring-the-client" title="Link to this heading">¶</a></h4>
<p>For using command <span class="target" id="gos-cmd-5"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> logging into the appliance is required.</p>
<p>The needed information is supplied either using command line switches or a configuration file (~/.config/gvm-tools.conf).</p>
<p>To provide the GMP user with command line switches use:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--gmp-username</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--gmp-password</span></code></p></li>
</ul>
<p>Alternatively a configuration file ~/.config/gvm-tools.conf containing the information can be created:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>Auth<span class="o">]</span>
<span class="nv">gmp_username</span><span class="o">=</span>webadmin
<span class="nv">gmp_password</span><span class="o">=</span>kennwort
</pre></div>
</div>
<p>This configuration file is not read by default. The command line switch <code class="docutils literal notranslate"><span class="pre">--config</span></code> or <code class="docutils literal notranslate"><span class="pre">-c</span></code> has to be added to read the configuration file.</p>
</section>
<section id="starting-a-scan-using-the-command-gvm-cli">
<span id="index-5"></span><h4><span class="section-number">14.3.1.2 </span>Starting a Scan Using the Command <code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code><a class="headerlink" href="#starting-a-scan-using-the-command-gvm-cli" title="Link to this heading">¶</a></h4>
<p>A typical example for using GMP is the automatic scan of a new system.</p>
<p>In the example it is assumed that an Intrusion Detection System (IDS) is used that monitors the systems in the Demilitarized Zone (DMZ) and immediately discovers new systems and unusual TCP ports that are not used already.
If such an event is discovered, the IDS should automatically initiate a scan of the new system with the help of a script.</p>
<p>For this, the command <span class="target" id="gos-cmd-6"></span><code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code> can be used although the command <span class="target" id="gos-cmd-7"></span><code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code> or using self written python scripts may be more suitable (see Chapter <a class="reference internal" href="#id2"><span class="std std-ref">14.3.2.1</span></a>).
The processing of the XML output is better supported by python than by using the shell.</p>
<p>Starting point is the IP address of the new suspected system.
A target must be created on the appliance for this IP address.</p>
<p>The command <span class="target" id="gos-gmp-0"></span><code class="docutils literal notranslate"><span class="pre">create_target</span></code> is described at:</p>
<p><a class="reference external" href="https://docs.greenbone.net/API/GMP/gmp-22.6.html#command_create_target">https://docs.greenbone.net/API/GMP/gmp-22.6.html#command_create_target</a>.</p>
<ol class="arabic simple">
<li><p>If the IP address is saved in the variable <code class="docutils literal notranslate"><span class="pre">IPADDRESS</span></code>, create the respective target as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span><span class="se">\</span>
--xml<span class="w"> </span><span class="s2">&quot;&lt;create_target&gt;&lt;name&gt;Suspect Host&lt;/name&gt;\</span>
<span class="s2">&lt;hosts&gt;</span><span class="nv">$IPADDRESS</span><span class="s2">&lt;/hosts&gt;&lt;/create_target&gt;&quot;</span>

&lt;create_target_response<span class="w"> </span><span class="nv">status</span><span class="o">=</span><span class="s2">&quot;201&quot;</span><span class="w"> </span><span class="nv">status_text</span><span class="o">=</span><span class="s2">&quot;OK, resource</span>
<span class="s2">created&quot;</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="s2">&quot;4574473f-a5d0-494c-be6f-3205be487793&quot;</span>/&gt;
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Create the task as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span><span class="se">\</span>
--xml<span class="w"> </span><span class="s2">&quot;&lt;create_task&gt;&lt;name&gt;Scan Suspect Host&lt;/name&gt; \</span>
<span class="s2">&lt;target id=\&quot;4574473f-a5d0-494c-be6f-3205be487793\&quot;&gt;&lt;/target&gt; \</span>
<span class="s2">&lt;config id=\&quot;daba56c8-73ec-11df-a475-002264764cea\&quot;&gt;&lt;/config&gt;&lt;/create_task&gt;&quot;</span>


&lt;create_task_response<span class="w"> </span><span class="nv">status</span><span class="o">=</span><span class="s2">&quot;201&quot;</span><span class="w"> </span><span class="nv">status_text</span><span class="o">=</span><span class="s2">&quot;OK, resource</span>
<span class="s2">created&quot;</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="s2">&quot;ce225181-c836-4ec1-b83f-a6fcba70e17d&quot;</span>/&gt;
</pre></div>
</div>
<p>→ The output is the ID of the task. It is required to start and monitor the task.</p>
<p>The other IDs used by the command can be retrieved using the following commands which display the available targets and scan configs:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span>--xml<span class="w"> </span><span class="s2">&quot;&lt;get_targets/&gt;&quot;</span>

$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span>--xml<span class="w"> </span><span class="s2">&quot;&lt;get_configs/&gt;&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output of the commands above is XML.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>Start the task as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span><span class="se">\</span>
--xml<span class="w"> </span><span class="s1">&#39;&lt;start_task task_id=&quot;ce225181-c836-4ec1-b83f-a6fcba70e17d&quot;/&gt;&#39;</span>
</pre></div>
</div>
<p>→ The connection will be closed by the appliance. The task is running.</p>
<ol class="arabic simple" start="4">
<li><p>Display the status of the task as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span><span class="se">\</span>
--xml<span class="w"> </span><span class="s1">&#39;&lt;get_tasks task_id=&quot;ce225181-c836-4ec1-b83f-a6fcba70e17d&quot;/&gt;&#39;</span>

&lt;get_tasks_response<span class="w"> </span><span class="nv">status</span><span class="o">=</span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="nv">status_text</span><span class="o">=</span><span class="s2">&quot;OK&quot;</span>&gt;&lt;apply_overrides&gt;
...&lt;status&gt;Running&lt;/status&gt;&lt;progress&gt;98&lt;host_progress&gt;
&lt;host&gt;192.168.255.254&lt;/host&gt;98&lt;/host_progress&gt;&lt;/progress&gt;.../&gt;
</pre></div>
</div>
<p>→ As soon as the scan is completed, the report can be downloaded.</p>
<p>For this the ID that was output when the task was created is required and a meaningful report format has to be entered.</p>
<ol class="arabic simple" start="5">
<li><p>Display the IDs for the report formats as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span>--xml<span class="w"> </span><span class="s1">&#39;&lt;get_report_formats/&gt;&#39;</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Load the report as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-cli<span class="w"> </span>--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span>ssh<span class="w"> </span><span class="se">\</span>
--hostname<span class="w"> </span><span class="m">192</span>.168.222.115<span class="w"> </span><span class="se">\</span>
--xml<span class="w"> </span><span class="s1">&#39;&lt;get_reports report_id=&quot;23a335d6-65bd-4be2-a83e-be330289eef7&quot; \</span>
<span class="s1">format_id=&quot;35ba7077-dc85-42ef-87c9-b0eda7e903b6&quot;/&gt;&#39;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To fully and automatically process the data, the task can be combined with an alert that forwards the report based on a given condition.</p>
</div>
</section>
</section>
<section id="accessing-with-gvm-pyshell">
<span id="gvm-pyshell"></span><span id="index-6"></span><h3><span class="section-number">14.3.2 </span>Accessing with <code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code><a class="headerlink" href="#accessing-with-gvm-pyshell" title="Link to this heading">¶</a></h3>
<p>The command line tool <span class="target" id="gos-cmd-8"></span><code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code> supplied by Greenbone offers the direct sending and receiving of XML commands and XML responses using python commands.
The commands take care of the generation and parsing of the XML data.</p>
<p>The tool supports the following connections:</p>
<ul class="simple">
<li><p>TLS</p></li>
<li><p>SSH</p></li>
<li><p>Socket</p></li>
</ul>
<p>While the current appliances use SSH to protect GMP, older appliances used TLS and Port 9390 to transport GMP.
The gvm-tools can be used with both the older and the current GOS.</p>
<p>The gvm-tools are mostly helpful for batch mode (<code class="docutils literal notranslate"><span class="pre">batch</span> <span class="pre">processing</span></code>, <code class="docutils literal notranslate"><span class="pre">scripting</span></code>).</p>
<p>The authentication configuration of the command <span class="target" id="gos-cmd-9"></span><code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code> can be stored in a file in the home directory of the user.
The syntax is explained in Chapter <a class="reference internal" href="#gvm-cli-conf"><span class="std std-ref">14.3.1.1</span></a>.</p>
<p>The Python implementation follows the GMP API (<a class="reference external" href="https://docs.greenbone.net/API/GMP/gmp-22.6.html">https://docs.greenbone.net/API/GMP/gmp-22.6.html</a>).
Optional arguments in the API are identified by a <code class="docutils literal notranslate"><span class="pre">?</span></code>.
The following example explains the usage of the Python functions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmp.create_task<span class="o">(</span><span class="s2">&quot;Name&quot;</span>,<span class="s2">&quot;Config&quot;</span>,<span class="s2">&quot;Scanner&quot;</span>,<span class="s2">&quot;Target&quot;</span>,comment<span class="o">=</span><span class="s2">&quot;comment&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While mandatory arguments can be supplied in the correct order and are identified automatically they can also be specified using their identifier:</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmp.create_task<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span>,config_id<span class="o">=</span><span class="s2">&quot;Config&quot;</span>,scanner_id<span class="o">=</span><span class="s2">&quot;Scanner&quot;</span>,
<span class="nv">target_id</span><span class="o">=</span><span class="s2">&quot;Target&quot;</span>,comment<span class="o">=</span><span class="s2">&quot;comment&quot;</span><span class="o">)</span>
</pre></div>
</div>
<section id="starting-a-scan-using-the-command-gvm-pyshell">
<span id="id2"></span><span id="index-7"></span><h4><span class="section-number">14.3.2.1 </span>Starting a Scan Using the Command <code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code><a class="headerlink" href="#starting-a-scan-using-the-command-gvm-pyshell" title="Link to this heading">¶</a></h4>
<p>A typical example for using GMP is the automatic scan of a new system.</p>
<p>In the example it is assumed that an Intrusion Detection System (IDS) is used that monitors the systems in the Demilitarized Zone (DMZ) and immediately discovers new systems and unusual TCP ports that are not used already.
If such an event is discovered, the IDS should automatically initiate a scan of the new system with the help of a script.</p>
<p>For this, the command <span class="target" id="gos-cmd-10"></span><code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code> is very suitable.
The processing of the XML output is better supported by python than by using the shell.</p>
<p>Starting point is the IP address of the new suspected system.
A target must be created on the appliance for this IP address.</p>
<p>The command <span class="target" id="gos-gmp-1"></span><code class="docutils literal notranslate"><span class="pre">create_target</span></code> is described at:</p>
<p><a class="reference external" href="https://docs.greenbone.net/API/GMP/gmp-22.6.html#command_create_target">https://docs.greenbone.net/API/GMP/gmp-22.6.html#command_create_target</a>.</p>
<ol class="arabic simple">
<li><p>The following lines illustrate the commands required when using gvm-pyshell:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>gvm-pyshell<span class="w"> </span><span class="se">\</span>
--gmp-username<span class="w"> </span>webadmin<span class="w"> </span>--gmp-password<span class="w"> </span>kennwort<span class="w"> </span><span class="se">\</span>
ssh<span class="w"> </span>--hostname<span class="w"> </span><span class="m">192</span>.168.222.115
GVM<span class="w"> </span>Interactive<span class="w"> </span>Console<span class="w"> </span><span class="m">2</span>.0.0<span class="w"> </span>API<span class="w"> </span><span class="m">1</span>.1.0.<span class="w"> </span>Type<span class="w"> </span><span class="s2">&quot;help&quot;</span><span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>information<span class="w"> </span>about
<span class="w">  </span>functionality.
&gt;&gt;&gt;<span class="w"> </span><span class="nv">res</span><span class="o">=</span>gmp.create_target<span class="o">(</span><span class="s2">&quot;Suspect Host&quot;</span>,<span class="w"> </span><span class="nv">make_unique</span><span class="o">=</span>True,<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="nv">hosts</span><span class="o">=[</span><span class="s1">&#39;192.168.255.254&#39;</span><span class="o">])</span>
&gt;&gt;&gt;<span class="w"> </span><span class="nv">target_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>res.xpath<span class="o">(</span><span class="s1">&#39;@id&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">]</span>
</pre></div>
</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">target_id</span></code> contains the ID of the created target. This ID can be used to create the corresponding task.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The task creation requires the following input:</p>
<ul class="simple">
<li><p>target_id</p></li>
<li><p>config_id</p></li>
<li><p>scanner_id</p></li>
<li><p>task_name</p></li>
<li><p>task_comment</p></li>
</ul>
</div>
<ol class="arabic simple" start="2">
<li><p>All existing scan configurations can be displayed as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span><span class="nv">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>gmp.get_configs<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span><span class="k">for</span><span class="w"> </span>i,<span class="w"> </span>conf<span class="w"> </span><span class="k">in</span><span class="w"> </span>enumerate<span class="o">(</span>res.xpath<span class="o">(</span><span class="s1">&#39;config&#39;</span><span class="o">))</span>:
...<span class="w">    </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>conf.xpath<span class="o">(</span><span class="s1">&#39;@id&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">]</span>
...<span class="w">    </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>conf.xpath<span class="o">(</span><span class="s1">&#39;name/text()&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">]</span>
...<span class="w">    </span>print<span class="o">(</span><span class="s1">&#39;\n({0}) {1}: ({2})&#39;</span>.format<span class="o">(</span>i,<span class="w"> </span>name,<span class="w"> </span>id<span class="o">))</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>All existing scanners can be displayed using the same technique. If only the built-in scanners are used the following IDs are hard coded:</p>
<ul class="simple">
<li><p>OpenVAS scanner: 08b69003-5fc2-4037-a479-93b440211c73</p></li>
<li><p>CVE scanner: 6acd0832-df90-11e4-b9d5-28d24461215b</p></li>
</ul>
</li>
<li><p>Create the task as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span><span class="nv">res</span><span class="o">=</span>gmp.create_task<span class="o">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Scan Suspect Host&quot;</span>,
...<span class="w"> </span><span class="nv">config_id</span><span class="o">=</span><span class="s2">&quot;daba56c8-73ec-11df-a475-002264764cea&quot;</span>,
...<span class="w"> </span><span class="nv">scanner_id</span><span class="o">=</span><span class="s2">&quot;08b69003-5fc2-4037-a479-93b440211c73&quot;</span>,
...<span class="w"> </span><span class="nv">target_id</span><span class="o">=</span>target_id<span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span><span class="nv">task_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>res.xpath<span class="o">(</span><span class="s1">&#39;@id&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Start the task as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;<span class="w"> </span>gmp.start_task<span class="o">(</span>task_id<span class="o">)</span>
</pre></div>
</div>
<p>→ The current connection is closed immediately. Further commands are not required.</p>
<p>All commands can be put in a Python script which may be invoked by the Python shell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">len_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>len<span class="o">(</span>args.script<span class="o">)</span><span class="w"> </span>-<span class="w"> </span><span class="m">1</span>
<span class="k">if</span><span class="w"> </span>len_args<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span><span class="m">2</span>:
<span class="w">    </span><span class="nv">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    This script creates a new task with specific host and vt!</span>
<span class="s2">    It needs two parameters after the script name.</span>
<span class="s2">    First one is name of the target and the second one is the</span>
<span class="s2">    chosen host. The task is called target-task</span>

<span class="s2">    Example:</span>
<span class="s2">        </span>$<span class="s2"> gvm-pyshell ssh newtask target host</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="w">    </span>print<span class="o">(</span>message<span class="o">)</span>
<span class="w">    </span>quit<span class="o">()</span>

<span class="nv">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>args.script<span class="o">[</span><span class="m">1</span><span class="o">]</span>
<span class="nv">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>args.script<span class="o">[</span><span class="m">2</span><span class="o">]</span>
<span class="nv">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>target<span class="w"> </span>+<span class="w"> </span><span class="s2">&quot; Task&quot;</span>

<span class="c1"># Full and Fast</span>
<span class="nv">myconfig_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;daba56c8-73ec-11df-a475-002264764cea&quot;</span>

<span class="c1"># OpenVAS Scanner</span>
<span class="nv">myscanner_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;08b69003-5fc2-4037-a479-93b440211c73&quot;</span>

<span class="nv">res</span><span class="o">=</span>gmp.create_target<span class="o">(</span>target,<span class="w"> </span>True,<span class="w"> </span><span class="nv">hosts</span><span class="o">=</span>host<span class="o">)</span>
<span class="nv">mytarget_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>res.xpath<span class="o">(</span><span class="s1">&#39;@id&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">]</span>

<span class="nv">res</span><span class="o">=</span>gmp.create_task<span class="o">(</span><span class="nv">name</span><span class="o">=</span>task,
<span class="w">                    </span><span class="nv">config_id</span><span class="o">=</span>myconfig_id,
<span class="w">                        </span><span class="nv">scanner_id</span><span class="o">=</span>myscanner_id,
<span class="w">                            </span><span class="nv">target_id</span><span class="o">=</span>mytarget_id<span class="o">)</span>
<span class="nv">mytask_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>res.xpath<span class="o">(</span><span class="s1">&#39;@id&#39;</span><span class="o">)[</span><span class="m">0</span><span class="o">]</span>

gmp.start_task<span class="o">(</span>mytask_id<span class="o">)</span>
</pre></div>
</div>
</section>
</section>
<section id="example-scripts">
<span id="index-8"></span><h3><span class="section-number">14.3.3 </span>Example Scripts<a class="headerlink" href="#example-scripts" title="Link to this heading">¶</a></h3>
<p>The gvm-tools come with a collection of example scripts providing various experimental functionalities and serving as a starting point for the development of custom scripts.</p>
<p>Currently the following scripts are available for gvm-tools: <a class="reference external" href="https://github.com/greenbone/gvm-tools/tree/main/scripts">https://github.com/greenbone/gvm-tools/tree/main/scripts</a></p>
<p>The scripts can be executed via the command <span class="target" id="gos-cmd-11"></span><code class="docutils literal notranslate"><span class="pre">gvm-script</span></code>.</p>
</section>
</section>
<section id="status-codes">
<span id="index-9"></span><h2><span class="section-number">14.4 </span>Status Codes<a class="headerlink" href="#status-codes" title="Link to this heading">¶</a></h2>
<p>GMP uses status codes similar to HTTP status codes.
The following codes are used:</p>
<dl>
<dt>2xx:</dt><dd><p>The command was sent, understood and accepted successfully.</p>
<dl class="simple">
<dt>200: OK</dt><dd></dd>
<dt>201: Resource created</dt><dd></dd>
<dt>202: Request submitted</dt><dd></dd>
</dl>
</dd>
<dt>4xx:</dt><dd><p>A user error occurred.</p>
<dl>
<dt>400: Syntax error</dt><dd><p>This includes different syntax errors.
Often elements or attributes in the GMP command are missing.
The status text shows additional information.</p>
<p>Currently this status code is also used for missing or wrong authentication.</p>
</dd>
<dt>401: Authenticate First</dt><dd><p>This is the error code that is used for missing or wrong authentication.
Currently the value 400 is still used.</p>
</dd>
<dt>403: Access to resource forbidden</dt><dd><p>This is the error code that is used for not having enough permissions.
Often <span class="target" id="gos-webui-0"></span><em>400: Permission denied</em> is displayed instead as well.</p>
</dd>
<dt>404: Resource missing</dt><dd><p>The resource could not be found.
The resource ID was empty or wrong.</p>
</dd>
<dt>409: Resource busy</dt><dd><p>This error code happens, for example, if the feed synchronization is started while it is already in progress.</p>
</dd>
</dl>
</dd>
<dt>5xx:</dt><dd><p>A server error occurred.</p>
<dl class="simple">
<dt>500: Internal Error</dt><dd><p>This can be caused by entries that exceed an internal buffer size.</p>
</dd>
<dt>503: Scanner loading NVTs</dt><dd><p>The scanner is currently busy loading the VTs from its cache.
The request should be made again at a later time.</p>
</dd>
<dt>503: Service temporarily down</dt><dd><p>Possibly the scanner daemon is not running.
Often the problem are expired certificates.</p>
</dd>
<dt>503: Service unavailable</dt><dd><p>The GMP command is blocked on the appliance.</p>
</dd>
</dl>
</dd>
</dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="master-sensor-setup.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">15 </span>Using a Master-Sensor Setup</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="managing-secinfo.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">13 </span>Managing SecInfo</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015–2025, Greenbone AG
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Aug 18, 2025</div>
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/greenbone/gsm-manual" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">14 Using the Greenbone Management Protocol</a><ul>
<li><a class="reference internal" href="#changes-to-gmp">14.1 Changes to GMP</a></li>
<li><a class="reference internal" href="#activating-gmp">14.2 Activating GMP</a></li>
<li><a class="reference internal" href="#using-gvm-tools">14.3 Using gvm-tools</a><ul>
<li><a class="reference internal" href="#accessing-with-gvm-cli">14.3.1 Accessing with <code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code></a><ul>
<li><a class="reference internal" href="#configuring-the-client">14.3.1.1 Configuring the Client</a></li>
<li><a class="reference internal" href="#starting-a-scan-using-the-command-gvm-cli">14.3.1.2 Starting a Scan Using the Command <code class="docutils literal notranslate"><span class="pre">gvm-cli</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#accessing-with-gvm-pyshell">14.3.2 Accessing with <code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code></a><ul>
<li><a class="reference internal" href="#starting-a-scan-using-the-command-gvm-pyshell">14.3.2.1 Starting a Scan Using the Command <code class="docutils literal notranslate"><span class="pre">gvm-pyshell</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-scripts">14.3.3 Example Scripts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#status-codes">14.4 Status Codes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8cef54a6"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>